#!/bin/bash

[ -d /usr/local/plan9 ] && export PLAN9=${PLAN9:-/usr/local/plan9}

# Let gs find the plan9port document fonts.
export GS_FONTPATH=$PLAN9/postscript/font

if [ $(uname -s) = Darwin ]; then
	export BROWSER=google-chrome
else
	export BROWSER=chromium-browser
fi
export NAMESPACE=/tmp/ns.$(hostname -s)
# Prompt (is almost a no-op in bash)
export H=`hostname | sed 's/\..*//'`

# Equivalent variables for rc(1).
export home=$HOME
export prompt=";; 	"
export user=$USER

# Set geometry per host
#if [ $H = quorra ]; then
#	res=$(/usr/sbin/system_profiler SPDisplaysDataType | grep Resolution | awk '{ print $2$3$4}')
#	export GEOMETRY=`echo $res | awk '{print $1"@1,86"}'`
#	unset res
#elif [ $H = moon ]; then
#	export GEOMETRY='1661x1109@1,86'
#else
#	export GEOMETRY='1280x800@1,86'
#fi

# Set default font.
#export font=/lib/font/bit/pelm/euro.8.font
export font=/lib/font/bit/lucsans/euro.8.font
export fixedfont=/lib/font/bit/pelm/unicode.8.font

# if $NAMESPACE doesn't exist, we need to create it.
[ -d $NAMESPACE ] ||  mkdir $NAMESPACE

if [ $TERM = dumb ]; then
	_cd(){
		\cd "$@" &&
		case "TERM!$-" in
		linux!*)
			;;
		*!*i*)
			awd
		esac
	}
	alias cd=_cd
	set +o emacs
	set +o vi
	set -a # autoexport
	unset PROMPT_COMMAND
	# Plumb files instead of starting new editor.
	export EDITOR='E'
	unset FCEDIT VISUAL
	# Make sure mpage prints in letter mode.
	export MPAGE="-t -bLetter"
	# Get rid of backspace characters in Unix man output.
	export PAGER=nobs
else
	export EDITOR='emacs'
	export PAGER='less'
fi

# start your engines.
[ -x $HOME/.p9p/bin/p9plumb ] && $HOME/.p9p/bin/p9plumb start
[ -f $HOME/.bashrc.d/functions ] && . $HOME/.bashrc.d/functions
