#!/bin/bash

cd $HOME

if [ -f ~/.bashrc ]; then
	  . ~/.bashrc
fi

set -e
set -a args

len()
{
	  echo ${#args[*]}
}

PLAN9=${PLAN9:-/usr/local/plan9}
tabstop=4
p9plumb start
res=$(/usr/sbin/system_profiler SPDisplaysDataType | grep Resolution | awk '{print $2$3$4}')
GEOMETRY=`echo $res | awk '{print $1"@1,86"}'`

args[$(len)]="-a"

if [ -f $HOME/acme.dump ]; then
	  args[$(len)]="-l $HOME/acme.dump"
elif [ -f $HOME/lib/acme/$H.dump ]; then
	  args[$(len)]="-l $HOME/lib/acme/$H.dump"
elif [ -f $HOME/$H.dump ]; then
	  args[$(len)]="-l $HOME/$H.dump"
else
	  [ ! -z $font ] && args[$(len)]="-f $font"
	  [ ! -z $fixedfont ] && args[$(len)]="-F $fixedfont"
fi

[ ! -z $GEOMETRY ] &&  args[$(len)]="-W $GEOMETRY"
[ $(len) = "0" ] && unset args

acme ${args[*]}
unset args
